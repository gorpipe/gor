

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>RELREMOVE &mdash; GOR Open Source v.2.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/gorpipe.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <nav class="wy-master-nav">
    <div class="gor-logo-home">
        <a href="../index.html">
            <img src="../_static/GORLogoText.svg" class="logo" />
        </a>
    </div>
    <div role="search" class="wxnc-search-form">
        <button class="wxnc-search-button" form="wxnc-search-form" formmethod="get">
            <i class="fa fa-search" aria-hidden="true"> </i>
        </button>
        <form id="wxnc-search-form" class="wy-form" action="../search.html" method="get">
            <input class="wxnc-no-right-border" size="30" type="text" name="q" placeholder="Search the user manual..."/>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
        </form>
    </div>
</nav>

  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            
            
              <div class="version">
                <a href="../index.html">
                  GOR Open Source
                  <p class="wxnc-subtitle">Documentation</p>
                </a>
              </div>
            
          

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../commands.html">Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../functions.html">Functions</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GOR Open Source</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>RELREMOVE</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span style="float:right; padding-top:10px; color:#BABABA;">Used in: gor only</span><section id="relremove-1">
<span id="relremove"></span><h1>RELREMOVE<a class="headerlink" href="#relremove-1" title="Permalink to this headline">¶</a></h1>
<p>The <strong>RELREMOVE</strong> command is used to remove related samples/individuals (PNs) from a phenotype relation.</p>
<p>The left-most column must be the sample identifier (e.g. PN) and the other columns should represent one or more phenotypes
with case-control-unknown statuses or quantitative trait (QT).  QTs use ‘NA’ to represent missing value while case-control
phenotypes can be in Plink compatible format (case/ctrl/unknown) = (2/1/-9), (2/1/NA), (2/1/0) or in a format like
(CASE/CTRL/EXCL) or (CASE/CTRL/NA).</p>
<p>Individuals that are “eliminated” are by default set to the unknown value, as defined in the column at hand, however,
this can be overwritten by the <code class="docutils literal notranslate"><span class="pre">-rsymb</span></code> option.  This can also be useful to inspect which samples are eliminated.</p>
<p>Cases and control are by default treated as one group, however, when there is a relationship between a case and a control,
the control is eliminated first.  The option <code class="docutils literal notranslate"><span class="pre">-sepcc</span></code> can be used to ignore relationships across the case and the control group.</p>
<p>The algorithm that eliminates relatives is greedy, i.e. eliminates the sample with the most relative first and then updates the
relative count after each elimination, continuing until there are no related pairs in each phenotype.</p>
<p>The relatives are supplied as a binary relation, e.g. (pn1,pn2).  Note that this relation does not have to be
symmetric because transitivity in relationships is assumed.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-gor notranslate"><div class="highlight"><pre><span></span><span class="nd">nor</span> phenotypes.tsv | RELREMOVE relative_relation [-sepcc] [-rsymb value]
</pre></div>
</div>
</section>
<section id="options">
<h2>Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-rsymb</span> <span class="pre">value</span></code></p></td>
<td><p>Symbol to over-write the definition of unknown/exclusion.</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">-sepcc</span></code></p></td>
<td><p>Treat cases and controls as separate groups when analyzing relationships.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">-weightcol</span> <span class="pre">col</span></code></p></td>
<td><p>A extra column with interger weights from 0 to 100.  Samples with larger weight are less likely
to be removed.  Non-integer numbers are treated as zero and number larger than 100 as 100</p></td>
</tr>
</tbody>
</table>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Eliminating relatives for 100 phenotypes in two steps, first closely related individuals - then less closely related individuals.</p>
<div class="highlight-gor notranslate"><div class="highlight"><pre><span></span><span class="nd">nor</span> pheno.tsv | select <span class="na">PN</span>,pheno1-pheno100
| relremove &lt;(<span class="nd">nor</span> relatives.tsv | where kinship &gt;= 0.2 | select pn1,pn2)
| relremove &lt;(<span class="nd">nor</span> relatives.tsv | where kinship &gt;= 0.05 | select pn1,pn2)
</pre></div>
</div>
<p>An short example showing how sample 2 and 3 are kept, 2 because of weight and 3 because of <code class="docutils literal notranslate"><span class="pre">-sepcc</span></code> option.</p>
<div class="highlight-gor notranslate"><div class="highlight"><pre><span></span>norrows 1 | calc pn &#39;1,2,3&#39; | calc weight &#39;10,20,10&#39; | select pn,weight | calc pheno &#39;2,2,1&#39;| split pn,weight,pheno
| relremove &lt;(norrows 1 | calc pn1 &#39;1,3&#39; | calc pn2 &#39;2&#39; | select pn1,pn2 | split pn1) -rsymb elim -sepcc -weightcol weight
</pre></div>
</div>
<p>Below are examples of self-contained tests that may help to explain the command.</p>
<div class="highlight-gor notranslate"><div class="highlight"><pre><span></span>/* Generate 100k samples */
<span class="nd">create</span> #pns# = norrows 100000 | calc pn #1 | select pn;

/* Generate artifical relationships */
<span class="nd">create</span> #r# = <span class="nd">nor</span> [#pns#] | multimap -cartesian &lt;(norrows 100 | group -lis -sc #1)
| replace #2 <span class="k">listfilter</span>(listmap(#2,&#39;round(10000*random())&#39;),&#39;random()&lt;0.05&#39;) | rename #1 pn1 | rename #2 pn2
| split pn2 | where pn2 != &#39;&#39; and pn1 != pn2;

/* Create several phenotypes */
<span class="nd">create</span> #pheno# = <span class="nd">nor</span> [#pns#]
| calc pheno1 if(random()&lt;0.01,&#39;NA&#39;,<span class="k">str</span>(random()))
| calc pheno2 mod(pn,3)
| calc pheno3 pheno1
| calc pheno4 decode(pheno2,&#39;0,NA,1,0,2,1&#39;)
| calc pheno5 decode(pheno2,&#39;0,-9,1,0,2,1&#39;);

/* Test if identical columns are treated in same way */
<span class="nd">create</span> #t1# = <span class="nd">nor</span> [#pheno#] | relremove [#r#] -rsymb hakon | throwif pheno3 != pheno1  | top 1;

/* Test if identical columns are treated in same way with -sepcc option */
<span class="nd">create</span> #t2# = <span class="nd">nor</span> [#pheno#] | relremove [#r#] -rsymb hakon -sepcc  | throwif pheno3 != pheno1  | top 1;

/* Test if identical columns are treated in same way with no option */
<span class="nd">create</span> #t3# = <span class="nd">nor</span> [#pheno#] | relremove [#r#] | throwif pheno3 != pheno1  | top 1;

/* Test if elim counts of identical columns are the same and that -sepcc option reduces the number of eliminated rows for case-control */
<span class="nd">create</span> #t4# = <span class="nd">nor</span> [#pheno#] | relremove [#r#] -rsymb elim | unpivot 2- | where col_value = &#39;elim&#39; | group -<span class="no">gc</span> col_name -<span class="no">count</span>
| pivot col_name -v pheno1,pheno2,pheno3,pheno4,pheno5 | rename (.*)_allcount #{1}
| multimap -cartesian &lt;(<span class="nd">nor</span> [#pheno#] | relremove [#r#] -sepcc -rsymb elim | unpivot 2- | where col_value = &#39;elim&#39; | group -<span class="no">gc</span> col_name -<span class="no">count</span>
| pivot col_name -v pheno1,pheno2,pheno3,pheno4,pheno5 | rename (.*)_allcount #{1})
| throwif pheno1 != pheno3 or pheno2!=pheno4 or pheno2 != pheno5 or pheno2 != pheno5 or pheno2 &lt; pheno2x or pheno4 &lt; pheno4x or pheno5 &lt; pheno5x;

/* Test if there are relatives after elimination */
<span class="nd">create</span> #t5# = <span class="nd">nor</span> [#pheno#] | select pn,pheno1 | relremove [#r#] -rsymb elim | where pheno1 != &#39;elim&#39; and pheno1 != &#39;NA&#39; | multimap -c pn [#r#]
| multimap -c pn2 &lt;(<span class="nd">nor</span> [#pheno#] | select pn,pheno1 | relremove [#r#] -rsymb elim | where pheno1 != &#39;elim&#39; and pheno1 != &#39;NA&#39;) | throwif 2=2;

/* Test if there are relatives after elimination within either case or ctrl groups */
<span class="nd">create</span> #t6# = <span class="nd">nor</span> [#pheno#] | select pn,pheno4 | relremove [#r#] -rsymb elim | where pheno4 != &#39;elim&#39; and pheno4 != &#39;NA&#39; | multimap -c pn [#r#]
| multimap -c pn2 &lt;(<span class="nd">nor</span> [#pheno#] | select pn,pheno4 | relremove [#r#] -rsymb elim  | where pheno4 != &#39;elim&#39; and pheno4 != &#39;NA&#39;) | throwif 2=2;

/* Test if there are relatives after elimination within same case-ctrl group */
<span class="nd">create</span> #t7# = <span class="nd">nor</span> [#pheno#] | select pn,pheno4 | relremove [#r#] -rsymb elim -sepcc | where pheno4 != &#39;elim&#39; and pheno4 != &#39;NA&#39;
| multimap -c pn [#r#] | multimap -c pn2 &lt;(<span class="nd">nor</span> [#pheno#] | select pn,pheno4 | relremove [#r#] -rsymb elim -sepcc
| where pheno4 != &#39;elim&#39; and pheno4 != &#39;NA&#39;) | where pheno4 = pheno4x | throwif 2=2;

/* Test if there are fewer eliminations than with a simple method */
<span class="nd">create</span> #t8# = <span class="nd">nor</span> [#pheno#] | select pn,pheno4 | relremove [#r#] -rsymb elim | where pheno4 = &#39;elim&#39; | group -<span class="no">count</span> | calc method &#39;relremove&#39;
| merge &lt;(<span class="nd">nor</span> [#pheno#] | select pn,pheno4
| inset -c pn -b &lt;(<span class="nd">nor</span> [#r#] | calc pn pn1+&#39;,&#39;+pn2 | select pn | split pn ) | where inset = 1 | group -<span class="no">count</span> | calc method &#39;simple&#39;)
| pivot method -v relremove,simple | throwif relremove_allcount &gt; simple_allcount;

/* Check that samples with the <span class="no">max</span> number of relatives are eliminated and that samples with no relatives are kept */
<span class="nd">create</span> #t9# = <span class="nd">nor</span> [#pheno#] | select pn | calc pheno random() | relremove [#r#] -rsymb elim
| map -c pn -m 1000 &lt;(<span class="nd">nor</span> [#r#] | calc pn pn1+&#39;,&#39;+pn2 | select pn | split pn | group -<span class="no">gc</span> pn -<span class="no">count</span> | rank allcount -o desc)
| throwif rank_allcount &gt; 0 and rank_allcount &lt; 5 and pheno != &#39;elim&#39; or allcount = 0 and pheno = &#39;elim&#39; | top 10;

<span class="nd">nor</span> [#t9#] | top 1
</pre></div>
</div>
</section>
</section>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020 GOR Open Source Project

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>